# التغييرات الجديدة في نظام معروضي

## نظرة عامة
تم تحديث النظام ليعمل بنظام تسجيل الدخول وإنشاء الحسابات قبل الوصول لصفحات طلب المعاريض.

## التغييرات الرئيسية

### 1. الصفحة الرئيسية (Hero Section)
- تم إضافة زرين رئيسيين:
  - **طلب كتابة معروض** (أزرق) - يطابق موضوعك 100%
  - **طلب معروض جاهز** (أخضر) - تحصل عليه فوراً

### 2. نظام المصادقة الجديد
- تم إنشاء صفحة `/auth` جديدة
- تدعم تسجيل الدخول وإنشاء حساب جديد
- تحفظ نوع الطلب المطلوب (custom/ready) في URL
- توجيه المستخدم للصفحة المناسبة بعد المصادقة

### 3. تحديث نموذج طلب المعروض
- إزالة حقول الاسم والبريد الإلكتروني (يتم أخذها من حساب المستخدم)
- إضافة فحص تسجيل الدخول
- توجيه المستخدم لصفحة المصادقة إذا لم يكن مسجل دخول

### 4. تحديث صفحة الصيغ الجاهزة
- إضافة فحص تسجيل الدخول
- توجيه المستخدم لصفحة المصادقة إذا لم يكن مسجل دخول

### 5. قاعدة البيانات
- إضافة حقل `password` لنموذج `User`
- تشفير كلمات المرور باستخدام bcryptjs

## المسارات الجديدة

### `/auth`
- صفحة تسجيل الدخول وإنشاء الحساب
- تدعم معاملات URL:
  - `?type=custom` - لطلب كتابة معروض
  - `?type=ready` - لطلب معروض جاهز

### API Endpoints الجديدة
- `POST /api/auth/register` - إنشاء حساب جديد
- `POST /api/auth/login` - تسجيل الدخول

## تدفق المستخدم

### طلب كتابة معروض:
1. المستخدم يضغط "طلب كتابة معروض"
2. يتم توجيهه لصفحة المصادقة مع `?type=custom`
3. بعد تسجيل الدخول/إنشاء الحساب
4. يتم توجيهه لصفحة نموذج طلب المعروض
5. النموذج يعرض بيانات المستخدم تلقائياً

### طلب معروض جاهز:
1. المستخدم يضغط "طلب معروض جاهز"
2. يتم توجيهه لصفحة المصادقة مع `?type=ready`
3. بعد تسجيل الدخول/إنشاء الحساب
4. يتم توجيهه لصفحة الصيغ الجاهزة

## الأمان
- كلمات المرور مشفرة باستخدام bcryptjs
- جلسات المستخدم تنتهي بعد 24 ساعة
- فحص تسجيل الدخول في جميع الصفحات المحمية

## التثبيت والتشغيل

### المتطلبات الجديدة
```bash
npm install bcryptjs @types/bcryptjs
```

### تحديث قاعدة البيانات
```bash
npx prisma migrate dev
npx prisma db seed
```

### تشغيل التطبيق
```bash
npm run dev
```

## ملاحظات مهمة
- جميع المستخدمين الحاليين يحتاجون لإعادة إنشاء كلمات مرور
- النظام يعمل مع المستخدمين الجدد فقط حالياً
- يمكن إضافة نظام استعادة كلمة المرور لاحقاً
- يمكن إضافة JWT tokens بدلاً من التشفير البسيط الحالي

## الاختبار
- جرب إنشاء حساب جديد
- جرب تسجيل الدخول
- جرب طلب كتابة معروض
- جرب طلب معروض جاهز
- تأكد من أن البيانات تُحفظ بشكل صحيح
